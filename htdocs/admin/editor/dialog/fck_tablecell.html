<!--
 * FCKeditor - The text editor for internet
 * Copyright (C) 2003 Frederico Caldeira Knabben
 *
 * Licensed under the terms of the GNU Lesser General Public License
 * (http://www.opensource.org/licenses/lgpl-license.php)
 *
 * For further information go to http://www.fredck.com/FCKeditor/ 
 * or contact fckeditor@fredck.com.
 *
 * fck_tablecell.html: Cell properties dialog box.
 *
 * Authors:
 *   Frederico Caldeira Knabben (fckeditor@fredck.com)
-->
<html>
	<head>
		<title>Свойства ячейки</title>
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
		<link href="../css/fck_dialog.css" type="text/css" rel="stylesheet">
		<script language="javascript">
<!--
// Array of selected Cells
var aTD = new Array() ;
	
function setDefaults()
{
	// Gets the document DOM
	var oDOM = dialogArguments.objContent.DOM ;
	var oRange = oDOM.selection.createRange() ;

	var oParent = oRange.parentElement() ;

	while (oParent && oParent.tagName != "TD" && oParent.tagName != "TABLE")
		oParent = oParent.parentNode ;

	if ( oParent.tagName == "TD" )
		aTD[0] = oParent ;
	else if ( oParent.tagName == "TABLE" )
	{
		// Loops throw all cells cheking if the selection, or part of it, is inside the cell
		// and then add it to the selectec cells collection
		for (i = 0 ; i < oParent.cells.length ; i++)
		{
			var oCellRange = oDOM.selection.createRange() ;
			oCellRange.moveToElementText(oParent.cells[i]) ;
			if ( oRange.inRange( oCellRange ) 
				|| ( oRange.compareEndPoints('StartToStart',oCellRange) >= 0 &&  oRange.compareEndPoints('StartToEnd',oCellRange) <= 0 )
				|| ( oRange.compareEndPoints('EndToStart',oCellRange) >= 0 &&  oRange.compareEndPoints('EndToEnd',oCellRange) <= 0 ) )
			{
				aTD[aTD.length] = oParent.cells[i] ;
			}
		}
	}
	
	if (aTD[0])
	{
		var iWidth = aTD[0].width ;
		
		if (iWidth.indexOf('%') >= 0)
		{
			iWidth = iWidth.substr(0,iWidth.length - 1) ;
			selWidthType.value = "percent" ;
		}
	
		txtWidth.value			= iWidth ;
		txtHeight.value			= aTD[0].height ;
		selWordWrap.value		= ! aTD[0].noWrap ;
		selHAlign.value			= aTD[0].align ;
		selVAlign.value			= aTD[0].vAlign ;
		txtRowSpan.value		= aTD[0].rowSpan ;
		txtCollSpan.value		= aTD[0].colSpan ;
		txtBackColor.value		= aTD[0].bgColor ; 
		txtBorderColor.value	= aTD[0].borderColor ;
	}
}

function ok()
{
	for( i = 0 ; i < aTD.length ; i++ )
	{
		if (txtWidth.value			!= "") aTD[i].width			= txtWidth.value + (selWidthType.value == "percent" ? "%" : "") ;		else aTD[i].removeAttribute("width") ;
		if (txtHeight.value			!= "") aTD[i].height		= txtHeight.value ;		else aTD[i].removeAttribute("height") ;
		if (selWordWrap.value		!= "") aTD[i].noWrap		= selWordWrap.value == "false" ; else aTD[i].removeAttribute("noWrap") ;
		if (selHAlign.value			!= "") aTD[i].align			= selHAlign.value ;		else aTD[i].removeAttribute("align") ;
		if (selVAlign.value			!= "") aTD[i].vAlign		= selVAlign.value ;		else aTD[i].removeAttribute("vAlign") ;
		if (txtRowSpan.value		!= "") aTD[i].rowSpan		= txtRowSpan.value ;	else aTD[i].removeAttribute("rowSpan") ;
		if (txtCollSpan.value		!= "") aTD[i].colSpan		= txtCollSpan.value ;	else aTD[i].removeAttribute("colSpan") ;
		if (txtBackColor.value		!= "") aTD[i].bgColor		= txtBackColor.value ;	else aTD[i].removeAttribute("bgColor") ;
		if (txtBorderColor.value	!= "") aTD[i].borderColor	= txtBorderColor.value ; else aTD[i].removeAttribute("borderColor") ;
	}
	
	cancel() ;
}

// Fired when the user press the CANCEL button.
function cancel() 
{
	window.returnValue = null ;
	window.close() ;
}

function SelectBackColor()
{
	var sColor = SelectColor() ;
	if (sColor) txtBackColor.value = sColor ;
}

function SelectBorderColor()
{
	var sColor = SelectColor() ;
	if (sColor) txtBorderColor.value = sColor ;
}

function SelectColor()
{
	return showModalDialog("fck_selcolor.html", "", "dialogWidth:370px;dialogHeight:240px;help:no;scroll:no;status:no") ;
}

function IsDigit()
{
	return ((event.keyCode >= 48) && (event.keyCode <= 57))
}
//-->
		</script>
	</head>
	<BODY bottommargin="5" leftmargin="15" topmargin="5" rightmargin="15" onload="setDefaults()">
		<TABLE cellSpacing="0" cellPadding="0" width="100%" border="0" height="100%">
			<TR>
				<TD>
					<TABLE cellSpacing="1" cellPadding="1" width="100%" border="0">
						<TR>
							<TD>
								<TABLE cellSpacing="0" cellPadding="0" border="0">
									<TR>
										<TD>Ширина:</TD>
										<TD>&nbsp;<INPUT onkeypress="event.returnValue=IsDigit();" id="txtWidth" type="text" maxLength="4" size="3" name="txtWidth">&nbsp;<SELECT id="selWidthType" name="selWidthType">
												<OPTION value="pixels" selected>пикселей</OPTION>
												<OPTION value="percent">процентов</OPTION>
											</SELECT></TD>
									</TR>
									<TR>
										<TD>Высота:</TD>
										<TD>&nbsp;<INPUT id="txtHeight" type="text" maxLength="4" size="3" name="txtHeight" onkeypress="event.returnValue=IsDigit();">&nbsp;пикселей</TD>
									</TR>
									<TR>
										<TD>&nbsp;</TD>
										<TD>&nbsp;</TD>
									</TR>
									<TR>
										<TD>Word Wrap:</TD>
										<TD>&nbsp;<SELECT id="selWordWrap" name="selAlignment">
												<OPTION value="" selected>&lt;Not set&gt;</OPTION>
												<OPTION value="true">Yes</OPTION>
												<OPTION value="false">No</OPTION>
											</SELECT></TD>
									</TR>
									<TR>
										<TD>&nbsp;</TD>
										<TD>&nbsp;</TD>
									</TR>
									<TR>
										<TD>Horizontal Alignment:</TD>
										<TD>&nbsp;<SELECT id="selHAlign" name="selAlignment">
												<OPTION value="" selected>&lt;Not set&gt;</OPTION>
												<OPTION value="left">Left</OPTION>
												<OPTION value="center">Center</OPTION>
												<OPTION value="right">Right</OPTION>
											</SELECT></TD>
									</TR>
									<TR>
										<TD>Vertival Alignement:</TD>
										<TD>&nbsp;<SELECT id="selVAlign" name="selAlignment">
												<OPTION value="" selected>&lt;Not set&gt;</OPTION>
												<OPTION value="top">Top</OPTION>
												<OPTION value="middle">Middle</OPTION>
												<OPTION value="bottom">Bottom</OPTION>
												<OPTION value="baseline">Baseline</OPTION>
											</SELECT></TD>
									</TR>
								</TABLE>
							</TD>
							<TD>&nbsp;&nbsp;&nbsp;</TD>
							<TD align="right">
								<TABLE cellSpacing="0" cellPadding="0" border="0">
									<TR>
										<TD>Rows Span:</TD>
										<TD>&nbsp; <INPUT onkeypress="event.returnValue=IsDigit();" id="txtRowSpan" type="text" maxLength="3" size="2" name="txtRows"></TD>
										<TD></TD>
									</TR>
									<TR>
										<TD>Columns Span:</TD>
										<TD>&nbsp; <INPUT onkeypress="event.returnValue=IsDigit();" id="txtCollSpan" type="text" maxLength="2" size="2" name="txtColumns"></TD>
										<TD></TD>
									</TR>
									<TR>
										<TD>&nbsp;</TD>
										<TD>&nbsp;</TD>
										<TD>&nbsp;</TD>
									</TR>
									<TR>
										<TD>&nbsp;</TD>
										<TD>&nbsp;</TD>
										<TD>&nbsp;</TD>
									</TR>
									<TR>
										<TD>&nbsp;</TD>
										<TD>&nbsp;</TD>
										<TD>&nbsp;</TD>
									</TR>
									<TR>
										<TD>Background Color:</TD>
										<TD>&nbsp;<INPUT id="txtBackColor" type="text" size="8" name="txtCellSpacing"></TD>
										<TD>&nbsp; <INPUT type="button" value="Select..." onclick="SelectBackColor()"></TD>
									</TR>
									<TR>
										<TD>Border&nbsp;Color:</TD>
										<TD>&nbsp;<INPUT id="txtBorderColor" type="text" size="8" name="txtCellPadding"></TD>
										<TD>&nbsp; <INPUT type="button" value="Select..." onclick="SelectBorderColor()"></TD>
									</TR>
								</TABLE>
							</TD>
						</TR>
					</TABLE>
				</TD>
			</TR>
			<TR>
				<TD align="middle"><BR>
					<INPUT type="button" value="Ok" onclick="ok();" style="WIDTH: 100px">&nbsp; <INPUT type="button" value="Cancel" onclick="cancel();">
				</TD>
			</TR>
		</TABLE>
	</BODY>
</html>
